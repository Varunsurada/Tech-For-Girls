const L=5,K='tfg_share_count',S='tfg_submitted',F=document.getElementById('registrationForm'),W=document.getElementById('whatsappShareBtn'),C=document.getElementById('shareCounter'),M=document.getElementById('shareCompleteMsg'),B=document.getElementById('submitBtn'),U=document.getElementById('successMsg'),g=()=>+localStorage.getItem(K)||0,s=v=>localStorage.setItem(K,v),i=()=>localStorage.getItem(S)==='true',m=()=>localStorage.setItem(S,'true'),u=()=>{let c=g();C.textContent=Click count: ${c}/${L};W.disabled=c>=L;M.classList.toggle('hidden',c<L)},d=t=>document.querySelectorAll('input,button').forEach(e=>e.disabled=!!t),h=t=>F.classList.toggle('disabled',!!t);window.addEventListener('DOMContentLoaded',()=>{u();if(i()){d(1);h(1);F.style.display='none';U.classList.remove('hidden')}});W.onclick=()=>{let c=g();if(c>=L)return;window.open(https://wa.me/?text=${encodeURIComponent('Hey Buddy, Join Tech For Girls Community! ðŸ˜Š Letâ€™s empower more girls in tech together!')},'_blank');s(++c);u()};F.onsubmit=async e=>{e.preventDefault();if(g()<L)return alert('Please share on WhatsApp 5 times before submitting!');B.disabled=1;try{let r=await fetch('YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL',{method:'POST',body:new FormData(F)}),j=await r.json();if(j.success){m();d(1);h(1);F.style.display='none';U.classList.remove('hidden')}else{alert('Submission failed: '+(j.error||'Unknown error.'));B.disabled=0}}catch{alert('Network or server error. Please try again later.');B.disabled=0}};